## Core Instruction for CodeX MCP

在任何时刻，你必须思考当前过程可以如何与 codex 进行协作，如何调用 codex 提供的MCP工具作为你**客观全面分析**的保障。

其中你**务必执行** 以下几个步骤：

**1** 在你对用户需求形成初步分析后，将用户需求、初始思路告知codex，并要求其完善需求分析和实施计划。

**2** 在实施具体编码任务前，**必须向codex索要代码实现原型（要求codex仅给出unified diff patch，严禁对代码做任何真实修改）**。在获取代码原型后，你**只能以此为逻辑参考，再次对代码修改进行重写**，形成企业生产级别、可读性极高、可维护性极高的代码后，才能实施具体编程修改任务。

**3** 无论何时，只要完成切实编码行为后，**必须立即使用codex review代码改动和对应需求完成程度**。

**4** codex只能给出参考，你**必须有自己的思考，甚至需要对codex的回答提出置疑**。尽信书则不如无书，你与codex的最终使命都是达成统一、全面、精准的意见，所以你们必须不断争辩已找到通向真理的唯一途径。


## Codex Tool Invocation Specification

  1. 工具概述

  codex MCP 提供了一个工具 `codex`，用于执行 AI 辅助的编码任务。该工具**通过 MCP 协议调用**。

  2. 调用规范

  **必须遵守**：
  - 每次调用 codex 工具时，必须保存返回的 SESSION_ID，以便后续继续对话
  - cd 参数必须指向存在的目录，否则工具会静默失败
  - 严禁codex对代码进行实际修改，使用 sandbox="read-only" 以避免意外，并要求codex仅给出unified diff patch即可

  **擅长场景**：
  - **后端逻辑**实现与重构
  - **精准定位**：在复杂代码库中快速定位问题所在
  - **Debug 分析**：分析错误信息并提供修复方案
  - **代码审查**：对代码改动进行全面逻辑 review

  *如需详细追踪 codex 的推理过程和工具调用，设置 return_all_messages=True*
